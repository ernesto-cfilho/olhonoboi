{% extends 'base.html' %}
{% load static %}

{% block title %}Relatórios - Olho no Gado{% endblock %}

{% block content %}
<!-- Header Section -->
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="text-primary">
                <i class="fas fa-chart-bar me-3"></i>
                Central de Relatórios
            </h1>
        </div>
    </div>
</div>

<!-- Report Types Cards -->
<div class="row g-4 mb-5">
    <div class="col-md-6">
        <div class="card h-100 shadow-sm border-0 report-card">
            <div class="card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h5 class="card-title mb-0">
                    <i class="fas fa-calendar-alt me-2"></i>
                    Relatório Mensal
                </h5>
            </div>
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-8">
                        <p class="card-text">Visualize dados detalhados do mês atual, incluindo:</p>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check text-success me-2"></i>Rebanho e vacinações</li>
                            <li><i class="fas fa-check text-success me-2"></i>Movimentação de estoque</li>
                            <li><i class="fas fa-check text-success me-2"></i>Custos e receitas</li>
                        </ul>
                    </div>
                    <div class="col-4 text-center">
                        <i class="fas fa-chart-line fa-4x text-primary opacity-75"></i>
                    </div>
                </div>
                <div class="d-grid">
                    <a href="{% url 'relatorio_mensal' %}" class="btn btn-lg" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white;">
                        <i class="fas fa-eye me-2"></i>Visualizar Relatório
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card h-100 shadow-sm border-0 report-card">
            <div class="card-header" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
                <h5 class="card-title mb-0">
                    <i class="fas fa-chart-pie me-2"></i>
                    Relatório Anual
                </h5>
            </div>
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-8">
                        <p class="card-text">Análise completa do desempenho anual com:</p>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check text-success me-2"></i>Crescimento do rebanho</li>
                            <li><i class="fas fa-check text-success me-2"></i>Produtividade</li>
                            <li><i class="fas fa-check text-success me-2"></i>Movimentação de estoque</li>
                        </ul>
                    </div>
                    <div class="col-4 text-center">
                        <i class="fas fa-chart-area fa-4x text-success opacity-75"></i>
                    </div>
                </div>
                <div class="d-grid">
                    <a href="{% url 'relatorio_anual' %}" class="btn btn-lg" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border: none; color: white;">
                        <i class="fas fa-eye me-2"></i>Visualizar Relatório
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Stats Section -->
<div class="row mb-4">
    <div class="col-12">
        <h3 class="mb-3">
            <i class="fas fa-tachometer-alt me-2 text-info"></i>
            Indicadores Rápidos
        </h3>
        {% if mes_atual %}
        <p class="text-muted mb-0">
            <i class="fas fa-calendar-alt me-1"></i>
            {{ mes_atual }}
        </p>
        {% endif %}
    </div>
</div>

<div class="row g-4 mb-5">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Animais Este Mês</h6>
                        <h2 class="mb-0">{{ animais_mes }}</h2>
                        <small><i class="fas fa-arrow-up"></i> +{{ animais_mes }} vs mês anterior</small>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-cow fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Vacinações</h6>
                        <h2 class="mb-0">{{ vacinacoes_mes }}</h2>
                        <small><i class="fas fa-syringe me-1"></i>Este mês</small>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-shield-alt fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-3">
        <div class="card bg-info text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Gastos do Mês</h6>
                        <h2 class="mb-0">R$ {{ gastos_mes|floatformat:2 }}</h2>
                        <small><i class="fas fa-dollar-sign me-1"></i>Total investido</small>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-money-bill-wave fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-3">
        <div class="card bg-warning text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title">Produtividade</h6>
                        <h2 class="mb-0">{{ produtividade_porcentagem|floatformat:0 }}%</h2>
                        <small><i class="fas fa-chart-line me-1"></i>Meta mensal</small>
                    </div>
                    <div class="align-self-center">
                        <i class="fas fa-target fa-2x opacity-75"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activities Section -->
<div class="row mb-5">
    <div class="col-12">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h5 class="card-title mb-0">
                    <i class="fas fa-clock me-2"></i>
                    Atividades Recentes
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr>
                                <th><i class="fas fa-tag me-2"></i>Tipo</th>
                                <th><i class="fas fa-info-circle me-2"></i>Atividade</th>
                                <th><i class="fas fa-calendar me-2"></i>Data</th>
                                <th><i class="fas fa-map-marker-alt me-2"></i>Fazenda</th>
                                <th><i class="fas fa-info me-2"></i>Detalhes</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for atividade in atividades_recentes %}
                            <tr>
                                <td>
                                    {% if atividade.tipo == 'criacao_lote' or atividade.tipo == 'lote' %}
                                        <span class="badge bg-info">
                                            <i class="fas fa-th-large me-1"></i>Criação de Lote
                                        </span>
                                    {% elif atividade.tipo == 'vacinacao' %}
                                        <span class="badge bg-warning">
                                            <i class="fas fa-syringe me-1"></i>Vacinação
                                        </span>
                                    {% elif atividade.tipo == 'movimentacao_estoque' %}
                                        <span class="badge bg-primary">
                                            <i class="fas fa-exchange-alt me-1"></i>Movimentação
                                        </span>
                                    {% elif atividade.tipo == 'entrada_animal' %}
                                        <span class="badge bg-success">
                                            <i class="fas fa-cow me-1"></i>Entrada Animal
                                        </span>
                                    {% elif atividade.tipo == 'animal' %}
                                        <span class="badge bg-success">
                                            <i class="fas fa-cow me-1"></i>Animal
                                        </span>
                                    {% elif atividade.tipo == 'produto' %}
                                        <span class="badge bg-secondary">
                                            <i class="fas fa-box me-1"></i>Produto
                                        </span>
                                    {% endif %}
                                </td>
                                <td>
                                    <strong>{{ atividade.nome }}</strong>
                                </td>
                                <td>
                                    {% if atividade.data %}
                                        {{ atividade.data|date:"d/m/Y" }}
                                    {% else %}
                                        N/A
                                    {% endif %}
                                </td>
                                <td>
                                    {{ atividade.fazenda }}
                                </td>
                                <td>
                                    <small class="text-muted">{{ atividade.descricao }}</small>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5" class="text-center py-4">
                                    <i class="fas fa-clock fa-3x text-muted mb-3"></i>
                                    <h6 class="text-muted">Nenhuma atividade recente</h6>
                                    <p class="text-muted small">As atividades aparecerão aqui conforme você criar lotes, vacinar animais e movimentar estoque.</p>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Custom Styles for Reports -->
<style>
.report-card:hover {
    transform: translateY(-5px);
    transition: transform 0.3s ease;
    box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
}

.card {
    transition: all 0.3s ease;
}

/* Efeitos hover para os botões dos relatórios */
.report-card .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
}

/* Gradientes mais suaves para os headers */
.card-header {
    border: none;
    font-weight: 600;
}
</style>

{% endblock %}
